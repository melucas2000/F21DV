<!-- Source: F21DV
     Author: Melanie Lucas
     Date: 18/01/2022 -->

<body></body>

<script src="https://d3js.org/d3.v7.min.js"></script>
<p>a</p>
<p>1</p>
<p>b</p>
<p>2</p>
<p>c</p>
<p>3</p>
<p>d</p>
<p>4</p>
<p>e</p>
<p>5</p>
<p>f</p>
<p>6</p>
<script>
  let heartfailurecsv =
    "https://raw.githubusercontent.com/akmand/datasets/master/heart_failure.csv";
  /*
age,anaemia,creatinine_phosphokinase,diabetes,ejection_fraction,high_blood_pressure,platelets,serum_creatinine,serum_sodium,sex,smoking,time,DEATH_EVENT
75,0,582,0,20,1,265000,1.9,130,1,0,4,1
55,0,7861,0,38,0,263358.03,1.1,136,1,0,6,1
65,0,146,0,20,0,162000,1.3,129,1,1,7,1
50,1,111,0,20,0,210000,1.9,137,1,0,7,1
*/

  // reads in csv
  d3.csv(heartfailurecsv, function (row) {
    return row;
    // function waits to be called until function above is read in
  }).then(function (data) {
    // filters through data and returns number of poeple older than 50
    const over50 = data.filter(function (row) {
      return row.age > 50;
    });
    // filters through data and returns number of poeple aged between 1 and 30
    const age1And30 = data.filter(function (row) {
      return row.age >= 1 && row.age <= 30;
    });
    // filters through data and returns number of poeple aged 31-40
    const age31And40 = data.filter(function (row) {
      return row.age >= 31 && row.age <= 40;
    });
    // filters through data and returns number of poeple aged 41-60
    const age41And60 = data.filter(function (row) {
      return row.age >= 41 && row.age <= 60;
    });
    // filters through data and returns number of poeple aged 61-100
    const age61And100 = data.filter(function (row) {
      return row.age >= 61 && row.age <= 100;
    });

    console.log("Over 50 =", over50.length);
    console.log("Age 1-30 =", age1And30.length);
    console.log("Age 31-40 =", age31And40.length);
    console.log("Age 41-60 =", age41And60.length);
    console.log("Age 61-100 =", age61And100.length);

    // store processed data in array
    var myData = [
      "Over 50:",
      over50.length,
      "Age 1-30:",
      age1And30.length,
      "Age 31-40:",
      age31And40.length,
      "Age 41-60:",
      age41And60.length,
      "Age 61-100 =",
      age61And100.length,
    ];

    var p = d3
      .select("body")
      .selectAll("p") // select all paragraph elements
      .data(myData) // pass processed data
      // print processed data
      .text(function (d, i) {
        return d;
      })
      .exit()
      .remove();
  });
</script>
